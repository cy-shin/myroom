<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">
<properties>
	<comment>basic-query.xml file</comment>
	
	<!-- 키워드로 검색 -->
	<entry key = 'searchKeyword'>
		SELECT CALL_NO, TOPIC_NAME, BOOK_NAME, AUTHOR, PUBLISHER, LOC_NAME, AVAIL_NAME, NVL(TO_CHAR(DUE_DATE, 'YYYY-MM-DD'), '-') DUE_DATE
		FROM LENT_RECORD MAIN
		RIGHT JOIN BOOK BOOK ON (MAIN.BOOK_NO = BOOK.BOOK_NO)
		JOIN TOPIC USING(TOPIC_CODE)
		JOIN LOCATION USING(LOC_CODE)
		JOIN AVAILABILITY USING(AVAIL_CODE)
		WHERE (REC_NO IS NULL
		OR REC_NO = (SELECT MAX(REC_NO) 
					 FROM LENT_RECORD SUB
					 WHERE MAIN.BOOK_NO = SUB.BOOK_NO))
		AND (BOOK_NAME LIKE '%' || ? || '%'
		OR AUTHOR LIKE '%' || ? || '%'
		OR PUBLISHER LIKE '%' || ? || '%')
	</entry>
	
	<entry key = 'searchDetail'>
		SELECT BOOK.BOOK_NO, CALL_NO, TOPIC_NAME, BOOK_NAME, AUTHOR, PUBLISHER, LOC_NAME, AVAIL_NAME, NVL(TO_CHAR(DUE_DATE, 'YYYY-MM-DD'),'-') DUE_DATE
		FROM LENT_RECORD MAIN
		RIGHT JOIN BOOK BOOK ON (MAIN.BOOK_NO = BOOK.BOOK_NO)
		JOIN TOPIC USING(TOPIC_CODE)
		JOIN LOCATION USING(LOC_CODE)
		JOIN AVAILABILITY USING(AVAIL_CODE)
		WHERE (REC_NO IS NULL
		OR REC_NO = (SELECT MAX(REC_NO) 
					 FROM LENT_RECORD SUB
					 WHERE MAIN.BOOK_NO = SUB.BOOK_NO))
		AND CALL_NO = ?
	</entry>
</properties>
